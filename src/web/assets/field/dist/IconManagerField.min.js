"undefined"==typeof IconManager&&(window.IconManager={}),IconManager.IconPicker=function(e,t){this.fieldId=e,this.settings=t||{},this.icons=[],this.showSearch=!1!==t.showSearch,this.showLabels=!1!==t.showLabels,this.iconSize=t.iconSize||"medium",this.iconsPerPage=t.iconsPerPage||100,this.allowMultiple=!0===t.allowMultiple,this.selectedIcons=[],this.iconsLoaded=!1,this.iconsLoading=!1,this.virtualScrollBatchSize=50,this.virtualScrollRenderedIcons={},this.virtualScrollObservers={},this.init()},IconManager.IconPicker.prototype={init:function(){this.$field=document.getElementById(this.fieldId),this.$field&&(this.$input=this.$field.querySelector('input[type="hidden"]'),this.$selectBtn=this.$field.querySelector(".icon-manager-select-btn"),this.$clearBtn=this.$field.querySelector(".icon-manager-clear-btn"),this.$picker=this.$field.querySelector(".icon-manager-picker"),this.$cancelBtn=this.$picker.querySelector(".icon-manager-cancel-btn"),this.$customLabelInput=this.$field.querySelector(".icon-manager-custom-label-input"),this.loadInitialFonts(),this.bindEvents())},bindEvents:function(){var e=this;this.currentValue=this.getCurrentValue(),this.allowMultiple&&(this.selectedIcons=Array.isArray(this.currentValue)?this.currentValue.slice():[]),this.bindCustomLabelInputs();var t=this.$field.querySelector(".icon-manager-selected");t&&(t.addEventListener("click",function(t){t.target.closest(".icon-manager-actions")||t.target.classList.contains("icon-manager-custom-label-input")||(t.preventDefault(),e.togglePicker())}),t.style.cursor="pointer"),this.$selectBtn&&this.$selectBtn.addEventListener("click",function(t){t.preventDefault(),e.togglePicker()}),this.$clearBtn&&this.$clearBtn.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),e.clearSelection()}),this.$cancelBtn&&this.$cancelBtn.addEventListener("click",function(t){t.preventDefault(),e.cancelSelection()});var n=this.$field.querySelector(".icon-manager-done-btn");n&&n.addEventListener("click",function(t){t.preventDefault(),e.hidePicker()});var i=this.$picker.querySelector(".icon-manager-search-input");i&&(i.addEventListener("input",function(t){e.filterIcons(t.target.value)}),i.addEventListener("click",function(e){e.stopPropagation()}),i.addEventListener("keyup",function(t){"Escape"===t.key&&(i.value="",e.filterIcons(""))})),this.$picker.querySelectorAll(".tab").forEach(function(t){t.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),e.switchTab(t.dataset.iconSet)})});var a=this.$picker.querySelector(".icon-manager-tab-select");a&&a.addEventListener("change",function(t){e.switchTab(t.target.value),e.updateDropdownCount(t.target.value)}),this.$picker.addEventListener("click",function(e){e.stopPropagation()}),document.addEventListener("click",function(t){e.$field.contains(t.target)||e.hidePicker()})},showPicker:function(){this.$picker.classList.remove("hidden"),this.savedValue=this.getCurrentValue(),this.allowMultiple&&(this.savedSelectedIcons=this.selectedIcons.slice()),this.iconsLoaded||this.iconsLoading?this.showIconsInPicker():this.fetchIconsForField(),this.focusSearchInput()},showIconsInPicker:function(){this.hideEmptyIconSets();var e=this.getCurrentValue(),t=null;if(this.allowMultiple&&this.selectedIcons.length>0?t=this.selectedIcons[0].iconSetHandle:e&&e.iconSetHandle&&(t=e.iconSetHandle),t)this.switchTab(t),this.updateDropdownCount(t);else{var n=this.$picker.querySelector(".icon-manager-tab-select");if(n&&n.value)this.updateDropdownCount(n.value);else{var i=this.findFirstNonEmptyIconSet();i&&this.switchTab(i)}}this.loadIcons(),this.updateIconCounts()},fetchIconsForField:function(){var e=this;this.iconsLoading=!0;var t=this.$picker.querySelectorAll(".icon-manager-grid");t.forEach(function(e){var t=e.querySelector(".icon-manager-grid-inner");t&&(t.innerHTML='<div class="icon-manager-loading">Loading icons...</div>')}),fetch(Craft.getCpUrl("icon-manager/icons/get-icons-for-field"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":Craft.csrfTokenValue,Accept:"application/json"},body:JSON.stringify({fieldId:this.settings.fieldId})}).then(function(e){return e.json()}).then(function(t){t.success&&t.icons?(e.icons=t.icons,e.iconsLoaded=!0,e.iconsLoading=!1,t.fonts&&t.fonts.length>0&&e.loadFonts(t.fonts),t.sprites&&t.sprites.length>0&&e.loadSprites(t.sprites),e.showIconsInPicker()):(console.error("Failed to load icons:",t.error||"Unknown error"),e.iconsLoading=!1)}).catch(function(n){console.error("Failed to load icons:",n),e.iconsLoading=!1,t.forEach(function(e){var t=e.querySelector(".icon-manager-grid-inner");t&&(t.innerHTML='<div class="icon-manager-error">Failed to load icons. Please try again.</div>')})})},hidePicker:function(){this.$picker.classList.add("hidden")},togglePicker:function(){this.$picker.classList.contains("hidden")?this.showPicker():this.hidePicker()},loadIcons:function(e){var t=this,n=this.$picker.querySelectorAll(".icon-manager-grid");if(e&&n.forEach(function(e){var n=e.dataset.iconSet;t.icons.some(function(e){return e.iconSetHandle===n})&&e.classList.remove("hidden")}),n.forEach(function(n){var i=n.querySelector(".icon-manager-grid-inner");if(i){var a=n.dataset.iconSet;if(t.icons.some(function(e){return e.iconSetHandle===a})){i.innerHTML="";var c=t.icons.filter(function(t){if(t.iconSetHandle!==a)return!1;if(e){var n=e.toLowerCase(),i=t.name.toLowerCase().includes(n),c=t.label&&t.label.toLowerCase().includes(n),r=t.keywords&&Array.isArray(t.keywords)&&t.keywords.some(function(e){return e&&e.toLowerCase&&e.toLowerCase().includes(n)});return i||c||r}return!0});if(n.dataset.iconsToShow=JSON.stringify(c),t.virtualScrollRenderedIcons[a]=0,t.renderIconBatch(i,c,a,t.virtualScrollBatchSize),c.length>t.virtualScrollBatchSize&&t.setupVirtualScrollObserver(i,c,a),0===c.length)if(e)n.style.display="none";else if(t.icons.some(function(e){return e.iconSetHandle===a}))i.innerHTML='<div class="icon-manager-empty">'+Craft.t("icon-manager","No icons found")+"</div>";else{n.style.display="none";var r=t.$picker.querySelector('.tab[data-icon-set="'+a+'"]');r&&r.parentNode&&(r.parentNode.style.display="none")}else n.style.display=""}else n.style.display="none"}}),e){var i=!1,a=null;n.forEach(function(e){var n=e.dataset.iconSet;t.icons.some(function(e){return e.iconSetHandle===n})&&"none"!==e.style.display&&(i=!0,a||(a=e))}),!i&&a&&(a.style.display="",a.querySelector(".icon-manager-grid-inner").innerHTML='<div class="icon-manager-empty">'+Craft.t("icon-manager","No icons match your search")+"</div>")}},filterIcons:function(e){if(e)this.$picker.classList.add("searching");else{this.$picker.classList.remove("searching");var t=this.$picker.querySelector(".tab.sel"),n=this.$picker.querySelector(".icon-manager-tab-select");t?this.switchTab(t.dataset.iconSet):n&&this.switchTab(n.value)}this.loadIcons(e),this.updateIconCounts(e)},switchTab:function(e){this.$picker.querySelectorAll(".tab").forEach(function(t){t.dataset.iconSet===e?t.classList.add("sel"):t.classList.remove("sel")});var t=this.$picker.querySelector(".icon-manager-tab-select");t&&t.value!==e&&(t.value=e),this.$picker.querySelectorAll(".icon-manager-grid").forEach(function(t){t.dataset.iconSet===e?t.classList.remove("hidden"):t.classList.add("hidden")})},selectIcon:function(e){if(this.allowMultiple){e.iconSetHandle,e.name;var t=this.selectedIcons.findIndex(function(t){return t.iconSetHandle===e.iconSetHandle&&t.name===e.name});t>-1?this.selectedIcons.splice(t,1):this.selectedIcons.push({iconSetHandle:e.iconSetHandle,name:e.name,type:e.type,value:e.value}),this.$input.value=JSON.stringify(this.selectedIcons),this.currentValue=this.selectedIcons,this.updateMultipleDisplay(),this.updateIconSelectionStates()}else{this.currentValue={iconSetHandle:e.iconSetHandle,name:e.name,type:e.type,value:e.value},this.$input.value=JSON.stringify(this.currentValue);var n=this.$field.querySelector(".icon-manager-selected"),i=n.querySelector(".icon-manager-placeholder"),a=n.querySelector(".icon-manager-selected-icon");if(i){var c=48,r=48;"small"===this.iconSize?(c=32,r=32):"large"===this.iconSize&&(c=64,r=54);var o='<div class="icon-manager-selected-icon">';if(e.content){var s=document.createElement("div");s.innerHTML=e.content;var l=s.querySelector("svg"),d=s.querySelector("i"),u=s.querySelector('span.icon, span[class*="material-"]');l?(l.setAttribute("width",c),l.setAttribute("height",c),o+=s.innerHTML):d&&e.isFontAwesome?(d.style.fontSize=r+"px",o+=s.innerHTML):u?(u.style.fontSize=r+"px",o+=s.innerHTML):o+=e.content}else o+='<svg width="'+c+'" height="'+c+'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><text x="12" y="16" text-anchor="middle">'+e.name.charAt(0).toUpperCase()+"</text></svg>";this.showLabels&&(o+='<div class="icon-manager-selected-label">'+(e.label||e.name)+"</div>"),o+="</div>",i.outerHTML=o}else a&&this.displayIcon(e,n,a,null);if(!this.$clearBtn){var h=n.querySelector(".icon-manager-actions"),f=document.createElement("button");f.type="button",f.className="btn icon-manager-clear-btn",f.textContent=Craft.t("icon-manager","Clear"),h.appendChild(f);var p=this;f.addEventListener("click",function(e){e.preventDefault(),p.clearSelection()}),this.$clearBtn=f}this.$selectBtn.textContent=Craft.t("icon-manager","Edit Selection"),this.updateIconSelectionStates()}},clearSelection:function(){if(this.allowMultiple)this.selectedIcons=[],this.currentValue=[],this.$input.value=JSON.stringify([]),this.updateMultipleDisplay();else{this.currentValue=null,this.$input.value="";var e=this.$field.querySelector(".icon-manager-selected").querySelector(".icon-manager-selected-icon");if(e){var t=48;"small"===this.iconSize?t=32:"large"===this.iconSize&&(t=64);var n='<div class="icon-manager-placeholder">';n+='<svg width="'+t+'" height="'+t+'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">',n+='<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>',n+='<line x1="9" y1="9" x2="15" y2="15"></line>',n+='<line x1="15" y1="9" x2="9" y2="15"></line>',n+="</svg>",n+='<div class="icon-manager-placeholder-text">'+Craft.t("icon-manager","No icon selected")+"</div>",n+="</div>",e.outerHTML=n}this.$selectBtn.textContent=Craft.t("icon-manager","Select Icons")}this.$clearBtn&&(this.$clearBtn.remove(),this.$clearBtn=null),this.$picker&&!this.$picker.classList.contains("hidden")&&this.updateIconSelectionStates()},updateMultipleDisplay:function(){var e=this,t=this.$field.querySelector(".icon-manager-selected"),n=48,i=48;"small"===this.iconSize?(n=32,i=32):"large"===this.iconSize&&(n=64,i=54);var a=t.querySelector(".icon-manager-selected-icons-grid"),c=t.querySelector(".icon-manager-placeholder");if(a&&a.remove(),c&&c.remove(),0===this.selectedIcons.length){var r='<div class="icon-manager-placeholder">';r+='<svg width="'+n+'" height="'+n+'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">',r+='<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>',r+='<line x1="9" y1="9" x2="15" y2="15"></line>',r+='<line x1="15" y1="9" x2="9" y2="15"></line>',r+="</svg>",r+='<div class="icon-manager-placeholder-text">'+Craft.t("icon-manager","No icons selected")+"</div>",r+="</div>",(o=t.querySelector(".icon-manager-actions")).insertAdjacentHTML("beforebegin",r),this.$selectBtn.textContent=Craft.t("icon-manager","Select Icons")}else{var o,s='<div class="icon-manager-selected-icons-grid">';if(this.selectedIcons.forEach(function(t){s+='<div class="icon-manager-selected-icon">';var a=e.icons.find(function(e){return e.iconSetHandle===t.iconSetHandle&&e.name===t.name});if(a&&a.content){var c=document.createElement("div");c.innerHTML=a.content;var r=c.querySelector("svg"),o=c.querySelector("i"),l=c.querySelector('span.icon, span[class*="material-"]');r?(r.setAttribute("width",n),r.setAttribute("height",n)):o?o.style.fontSize=i+"px":l&&(l.style.fontSize=i+"px"),s+=c.innerHTML}else s+='<svg width="'+n+'" height="'+n+'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><text x="12" y="16" text-anchor="middle">'+t.name.charAt(0).toUpperCase()+"</text></svg>";e.showLabels&&(s+='<div class="icon-manager-selected-label">'+(a?a.label||a.name:t.name)+"</div>"),s+="</div>"}),s+="</div>",(o=t.querySelector(".icon-manager-actions")).insertAdjacentHTML("beforebegin",s),this.$selectBtn.textContent=Craft.t("icon-manager","Edit Selection"),!this.$clearBtn){var l=document.createElement("button");l.type="button",l.className="btn icon-manager-clear-btn",l.textContent=Craft.t("icon-manager","Clear"),o.appendChild(l),l.addEventListener("click",function(t){t.preventDefault(),e.clearSelection()}),this.$clearBtn=l}}this.bindCustomLabelInputs()},updateIconSelectionStates:function(){var e=this;this.$picker.querySelectorAll(".icon-manager-grid-item").forEach(function(t){var n=JSON.parse(t.dataset.iconData);(e.allowMultiple?e.selectedIcons.some(function(e){return e.iconSetHandle===n.iconSetHandle&&e.name===n.name}):e.currentValue&&e.currentValue.iconSetHandle===n.iconSetHandle&&e.currentValue.name===n.name)?t.classList.add("selected"):t.classList.remove("selected")})},getCurrentValue:function(){if(this.$input.value)try{return JSON.parse(this.$input.value)}catch(e){return null}return null},updateIconCounts:function(e){var t={};this.icons.forEach(function(n){if(t[n.iconSetHandle]||(t[n.iconSetHandle]=0),e){var i=e.toLowerCase(),a=n.name.toLowerCase().includes(i),c=n.label&&n.label.toLowerCase().includes(i),r=n.keywords&&Array.isArray(n.keywords)&&n.keywords.some(function(e){return e&&e.toLowerCase&&e.toLowerCase().includes(i)});(a||c||r)&&t[n.iconSetHandle]++}else t[n.iconSetHandle]++}),this.$picker.querySelectorAll(".icon-count").forEach(function(e){var n=e.dataset.iconSet,i=t[n]||0;e.textContent="("+i.toLocaleString()+")"});var n=this.$picker.querySelector(".icon-count-dropdown");if(n){var i=n.dataset.iconSet,a=t[i]||0;n.textContent="("+a.toLocaleString()+" icons)"}if(e){var c=this.$picker.querySelector(".tab.sel");if((i=c?c.dataset.iconSet:null)&&0===t[i])for(var r in t)if(t[r]>0){this.switchTab(r);break}}},updateDropdownCount:function(e){var t=this.$picker.querySelector(".icon-count-dropdown");if(t){t.dataset.iconSet=e;var n=0;this.icons.forEach(function(t){t.iconSetHandle===e&&n++}),t.textContent="("+n+" icons)"}},hideEmptyIconSets:function(){var e={};this.icons.forEach(function(t){e[t.iconSetHandle]||(e[t.iconSetHandle]=0),e[t.iconSetHandle]++}),this.$picker.querySelectorAll(".tab").forEach(function(t){var n=t.dataset.iconSet;e[n]&&0!==e[n]?t.parentNode.style.display="":t.parentNode.style.display="none"});var t=this.$picker.querySelector(".icon-manager-tab-select");t&&t.querySelectorAll("option").forEach(function(t){var n=t.value;e[n]&&0!==e[n]?(t.style.display="",t.disabled=!1):(t.style.display="none",t.disabled=!0)})},findFirstNonEmptyIconSet:function(){var e={};for(var t in this.icons.forEach(function(t){e[t.iconSetHandle]||(e[t.iconSetHandle]=0),e[t.iconSetHandle]++}),e)if(e[t]>0)return t;return null},cancelSelection:function(){this.allowMultiple?(this.selectedIcons=this.savedSelectedIcons?this.savedSelectedIcons.slice():[],this.currentValue=this.selectedIcons,this.$input.value=JSON.stringify(this.selectedIcons),this.updateMultipleDisplay()):(this.savedValue?(this.currentValue=this.savedValue,this.$input.value=JSON.stringify(this.savedValue)):(this.currentValue=null,this.$input.value=""),this.updateDisplay()),this.hidePicker()},updateDisplay:function(){var e=this,t=this.$field.querySelector(".icon-manager-selected"),n=t.querySelector(".icon-manager-selected-icon"),i=t.querySelector(".icon-manager-placeholder"),a=t.querySelector(".icon-manager-actions");if(this.currentValue){var c=this.icons.find(function(t){return t.iconSetHandle===e.currentValue.iconSetHandle&&t.name===e.currentValue.name});c?this.displayIcon(c,t,n,i):fetch(Craft.getCpUrl("icon-manager/icons/get-data"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":Craft.csrfTokenValue,Accept:"application/json"},body:JSON.stringify({iconSet:this.currentValue.iconSetHandle,icon:this.currentValue.name})}).then(function(e){return e.json()}).then(function(a){a.success&&a.icon&&e.displayIcon(a.icon,t,n,i)}).catch(function(e){console.error("Failed to load icon:",e)});var r=a.querySelector(".icon-manager-clear-btn");if(r)this.$clearBtn=r;else{var o=document.createElement("button");o.type="button",o.className="btn icon-manager-clear-btn",o.textContent=Craft.t("icon-manager","Clear"),a.appendChild(o),o.addEventListener("click",function(t){t.preventDefault(),e.clearSelection()}),this.$clearBtn=o}this.$selectBtn.textContent=Craft.t("icon-manager","Edit Selection")}else{if(n){var s=48;"small"===this.iconSize?s=32:"large"===this.iconSize&&(s=64);var l='<div class="icon-manager-placeholder">';l+='<svg width="'+s+'" height="'+s+'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">',l+='<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>',l+='<line x1="9" y1="9" x2="15" y2="15"></line>',l+='<line x1="15" y1="9" x2="9" y2="15"></line>',l+="</svg>",l+='<div class="icon-manager-placeholder-text">'+Craft.t("icon-manager","No icon selected")+"</div>",l+="</div>",n.outerHTML=l}this.$clearBtn&&(this.$clearBtn.remove(),this.$clearBtn=null),this.$selectBtn.textContent=Craft.t("icon-manager","Select Icons")}},bindCustomLabelInputs:function(){var e=this,t=this.$field.querySelector(".icon-manager-custom-label-input");t&&!this.allowMultiple&&t.addEventListener("input",function(t){e.updateSingleCustomLabel(t.target.value)}),this.$field.querySelectorAll("[data-icon-index]").forEach(function(t){var n=parseInt(t.dataset.iconIndex);e.selectedIcons&&e.selectedIcons[n]&&t.value&&(e.selectedIcons[n].hasOwnProperty("customLabel")||(e.selectedIcons[n].customLabel=t.value)),t.addEventListener("input",function(t){e.updateMultipleCustomLabel(n,t.target.value)})})},updateSingleCustomLabel:function(e){this.currentValue&&(this.currentValue.customLabel=e,this.$input.value=JSON.stringify(this.currentValue))},updateMultipleCustomLabel:function(e,t){this.allowMultiple&&this.selectedIcons&&this.selectedIcons[e]&&(this.selectedIcons[e].customLabel=t,this.currentValue=this.selectedIcons,this.$input.value=JSON.stringify(this.selectedIcons))},displayIcon:function(e,t,n,i){var a=48,c=48;"small"===this.iconSize?(a=32,c=32):"large"===this.iconSize&&(a=64,c=54);var r='<div class="icon-manager-selected-icon">';if(e.content){var o=document.createElement("div");o.innerHTML=e.content;var s=o.querySelector("svg"),l=o.querySelector("i"),d=o.querySelector('span.icon, span[class*="material-"]');s?(s.setAttribute("width",a),s.setAttribute("height",a)):l?l.style.fontSize=c+"px":d&&(d.style.fontSize=c+"px"),r+=o.innerHTML}else r+='<svg width="'+a+'" height="'+a+'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><text x="12" y="16" text-anchor="middle">'+e.name.charAt(0).toUpperCase()+"</text></svg>";this.showLabels&&(r+='<div class="icon-manager-selected-label">'+(e.label||e.name)+"</div>"),r+="</div>",i?i.outerHTML=r:n&&(n.outerHTML=r)},renderIconBatch:function(e,t,n,i){for(var a=this.virtualScrollRenderedIcons[n]||0,c=Math.min(a+i,t.length),r=a;r<c;r++){var o=t[r],s=this.createIconElement(o);e.appendChild(s)}return this.virtualScrollRenderedIcons[n]=c,c<t.length},createIconElement:function(e){var t=this,n=document.createElement("div");n.className="icon-manager-grid-item",(this.allowMultiple?this.selectedIcons.some(function(t){return t.iconSetHandle===e.iconSetHandle&&t.name===e.name}):this.currentValue&&this.currentValue.iconSetHandle===e.iconSetHandle&&this.currentValue.name===e.name)&&(n.className+=" selected"),n.dataset.iconData=JSON.stringify(e);var i=document.createElement("div");i.className="icon-manager-grid-item-icon";var a=48,c=48;if("small"===this.iconSize?(a=32,c=32):"large"===this.iconSize&&(a=64,c=54),e.content){var r=document.createElement("div");r.innerHTML=e.content;var o=r.querySelector("svg"),s=r.querySelector("i"),l=r.querySelector('span.icon, span[class*="material-"]');o?(o.setAttribute("width",a),o.setAttribute("height",a)):s?s.style.fontSize=c+"px":l&&(l.style.fontSize=c+"px"),i.innerHTML=r.innerHTML}else i.innerHTML='<svg width="'+a+'" height="'+a+'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><text x="12" y="16" text-anchor="middle" font-size="10">'+e.name.charAt(0).toUpperCase()+"</text></svg>";if(n.appendChild(i),this.showLabels){var d=document.createElement("div");d.className="icon-manager-grid-item-label",d.textContent=e.label||e.name,n.appendChild(d)}return n.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),t.selectIcon(e)}),n},setupVirtualScrollObserver:function(e,t,n){var i=this;this.virtualScrollObservers[n]&&this.virtualScrollObservers[n].disconnect();var a=document.createElement("div");a.className="virtual-scroll-loading",a.style.padding="2rem",a.style.textAlign="center",a.style.color="#6b7280",a.style.fontSize="0.875rem",a.style.fontWeight="500",a.innerHTML="Loading more icons...",e.appendChild(a);var c=document.createElement("div");c.className="virtual-scroll-sentinel",c.style.height="1px",c.style.width="100%",e.appendChild(c);var r=new IntersectionObserver(function(o){o.forEach(function(o){o.isIntersecting&&(i.renderIconBatchBeforeElement(e,t,n,i.virtualScrollBatchSize,a)||(r.disconnect(),c.remove(),a.remove()))})},{root:null,rootMargin:"200px",threshold:.1});r.observe(c),this.virtualScrollObservers[n]=r},renderIconBatchBeforeElement:function(e,t,n,i,a){for(var c=this.virtualScrollRenderedIcons[n]||0,r=Math.min(c+i,t.length),o=c;o<r;o++){var s=t[o],l=this.createIconElement(s);e.insertBefore(l,a)}return this.virtualScrollRenderedIcons[n]=r,r<t.length},loadFonts:function(e){e.forEach(function(e){if("remote"===e.type&&e.url){if(!document.querySelector('link[href="'+e.url+'"]')){var t=document.createElement("link");t.rel="stylesheet",t.href=e.url,t.crossOrigin="anonymous",document.head.appendChild(t)}}else if("inline"===e.type&&e.css){var n=document.querySelector("style[data-icon-manager-inline]");if(n)n.textContent+="\n"+e.css;else{var i=document.createElement("style");i.setAttribute("data-icon-manager-inline","true"),i.textContent=e.css,document.head.appendChild(i)}}})},loadSprites:function(e){var t=this;e.forEach(function(e){document.getElementById("icon-manager-sprite-"+e.name)||fetch(e.url).then(function(e){return e.text()}).then(function(n){t.injectSprite(e.name,n)}).catch(function(t){console.error("Failed to load sprite:",e.name,t)})})},injectSprite:function(e,t){t=t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"");var n=document.createElement("div");n.id="icon-manager-sprite-"+e,n.style.display="none",n.innerHTML=t,document.body.insertBefore(n,document.body.firstChild),console.log("Injected sprite:",e)},focusSearchInput:function(){var e=this.$picker.querySelector(".icon-manager-search-input");e&&setTimeout(function(){e.focus()},100)},loadInitialFonts:function(){}};